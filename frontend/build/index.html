<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–ò-–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç | –ö–∞—Ä—å–µ—Ä–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
        
        .workflow-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .step-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .step-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .step-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }
        
        .step-card p {
            opacity: 0.9;
            line-height: 1.6;
        }
        
        .step-number {
            background: rgba(255,255,255,0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
        }
        
        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .feature {
            text-align: center;
            padding: 20px;
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        footer {
            text-align: center;
            color: white;
            opacity: 0.8;
            padding: 20px;
        }
        
        .status-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .api-status {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <div class="status-indicator">
        üü¢ –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞
    </div>
    
    <div class="container">
        <header>
            <h1>–ò–ò-–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç</h1>
            <p>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è</p>
        </header>
        
        <div class="main-content">
            <h2 style="text-align: center; margin-bottom: 30px; color: #333;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            
            <div class="workflow-steps">
                <div class="step-card" onclick="startWorkflow()">
                    <div class="step-number">1</div>
                    <h3>–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ</h3>
                    <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à–µ —Ä–µ–∑—é–º–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ —É–ª—É—á—à–µ–Ω–∏—é</p>
                </div>
                
                <div class="step-card" onclick="alert('–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–µ–∑—é–º–µ')">
                    <div class="step-number">2</div>
                    <h3>–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ</h3>
                    <p>–ü—Ä–æ–π–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ —Å –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–∞—à–∏—Ö –Ω–∞–≤—ã–∫–æ–≤</p>
                </div>
                
                <div class="step-card" onclick="alert('–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ')">
                    <div class="step-number">3</div>
                    <h3>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
                    <p>–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≤—ã–∫–æ–≤</p>
                </div>
                
                <div class="step-card" onclick="alert('–ó–∞–≤–µ—Ä—à–∏—Ç–µ –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —ç—Ç–∞–ø—ã')">
                    <div class="step-number">4</div>
                    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
                    <p>–ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –∏ –ø–ª–∞–Ω–æ–º —Ä–∞–∑–≤–∏—Ç–∏—è</p>
                </div>
            </div>
            
            <button class="start-button" onclick="startWorkflow()">
                –ù–∞—á–∞—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é
            </button>
            
            <div class="api-status">
                <h4>–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã:</h4>
                <p>‚úÖ Backend API: <span id="backend-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
                <p>‚úÖ Frontend: –ê–∫—Ç–∏–≤–µ–Ω</p>
                <p>‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã: –ì–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ</p>
            </div>
            
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">ü§ñ</div>
                    <h4>–ò–ò-–∞–Ω–∞–ª–∏–∑</h4>
                    <p>–£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</p>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">üí¨</div>
                    <h4>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h4>
                    <p>–ñ–∏–≤–æ–µ –æ–±—â–µ–Ω–∏–µ —Å –ò–ò-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏</p>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">üìä</div>
                    <h4>–î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã</h4>
                    <p>–ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>
                </div>
                
                <div class="feature">
                    <div class="feature-icon">üéØ</div>
                    <h4>–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è</h4>
                    <p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –∫–∞–∂–¥–æ–º—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>&copy; 2024 –ò–ò-–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </footer>
    </div>
    
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
        const API_BASE = 'http://localhost:8000/api';
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ backend API
        async function checkBackendStatus() {
            try {
                const response = await fetch('http://localhost:8000/');
                if (response.ok) {
                    document.getElementById('backend-status').textContent = '–ê–∫—Ç–∏–≤–µ–Ω (http://localhost:8000)';
                    document.getElementById('backend-status').style.color = '#28a745';
                } else {
                    throw new Error('Backend –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                }
            } catch (error) {
                document.getElementById('backend-status').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                document.getElementById('backend-status').style.color = '#dc3545';
            }
        }
        
        function startWorkflow() {
            // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∑—é–º–µ
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 500px; width: 90%;">
                    <h3 style="margin-bottom: 20px; text-align: center;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ</h3>
                    <form id="resume-form" enctype="multipart/form-data">
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 10px; font-weight: bold;">–ò–º—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:</label>
                            <input type="text" id="candidate-name" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 10px; font-weight: bold;">–§–∞–π–ª —Ä–µ–∑—é–º–µ:</label>
                            <input type="file" id="resume-file" accept=".pdf,.docx,.txt" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;" required>
                            <small style="color: #666;">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: PDF, DOCX, TXT</small>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <button type="submit" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                            <button type="button" onclick="this.closest('.modal').remove()" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                    <div id="upload-status" style="margin-top: 20px; text-align: center;"></div>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
            document.getElementById('resume-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const formData = new FormData();
                const fileInput = document.getElementById('resume-file');
                const nameInput = document.getElementById('candidate-name');
                const statusDiv = document.getElementById('upload-status');
                
                if (!fileInput.files[0]) {
                    statusDiv.innerHTML = '<p style="color: red;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</p>';
                    return;
                }
                
                statusDiv.innerHTML = '<p style="color: blue;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
                
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –∏–º—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –∏–∑ —Ñ–æ—Ä–º—ã
                    const candidateName = nameInput.value || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç';
                    
                    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
                    const sessionResponse = await fetch(`${API_BASE}/create-session`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            candidate_name: candidateName
                        })
                    });
                    
                    if (!sessionResponse.ok) {
                        throw new Error(`–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏: ${sessionResponse.status}`);
                    }
                    
                    const sessionData = await sessionResponse.json();
                    console.log('–î–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏:', sessionData);
                    
                    const sessionId = sessionData.session_id;
                    
                    if (!sessionId) {
                        throw new Error('–ù–µ –ø–æ–ª—É—á–µ–Ω session_id –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
                    }
                    
                    console.log('Session ID:', sessionId);
                    
                    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
                    const formData = new FormData();
                    formData.append('file', fileInput.files[0]);
                    formData.append('session_id', sessionId);
                    
                    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—é–º–µ
                    const uploadResponse = await fetch(`${API_BASE}/upload-resume`, {
                        method: 'POST',
                        body: formData
                    });

                    if (!uploadResponse.ok) {
                        throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${uploadResponse.status}`);
                    }

                    const uploadResult = await uploadResponse.json();
                    console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏:', uploadResult);
                    
                    if (uploadResponse.ok) {
                        statusDiv.innerHTML = `
                            <div style="color: green;">
                                <h4>‚úÖ –†–µ–∑—é–º–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!</h4>
                                <p><strong>–°–µ—Å—Å–∏—è:</strong> ${sessionId}</p>
                                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${uploadResult.status}</p>
                                <button onclick="startInterview('${sessionId}')" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 15px; cursor: pointer; margin-top: 10px;">–ù–∞—á–∞—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ</button>
                            </div>
                        `;
                    } else {
                        statusDiv.innerHTML = `<p style="color: red;">–û—à–∏–±–∫–∞: ${uploadResult.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</p>`;
                    }
                } catch (error) {
                    statusDiv.innerHTML = `<p style="color: red;">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}</p>`;
                }
            });
        }
        
        function startInterview(sessionId) {
            // –°–æ–∑–¥–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è
            const interviewModal = document.createElement('div');
            interviewModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1001;
            `;
            
            interviewModal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 20px; max-width: 800px; width: 95%; max-height: 90vh; overflow-y: auto;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ - –°–µ—Å—Å–∏—è: ${sessionId}</h3>
                        <button onclick="this.closest('div').remove()" style="background: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer;">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                    </div>
                    
                    <div id="chat-messages" style="height: 400px; overflow-y: auto; border: 2px solid #eee; padding: 20px; margin-bottom: 20px; border-radius: 10px; background: #f8f9fa;">
                        <div style="text-align: center; color: #666;">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è...</div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                        <input type="text" id="user-message" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..." style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 25px;" onkeypress="if(event.key==='Enter') sendMessage('${sessionId}')">
                        <button onclick="sendMessage('${sessionId}')" style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button id="voice-btn" onclick="toggleVoiceMode('${sessionId}')" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º</button>
                        <button onclick="completeInterview('${sessionId}')" style="background: #ffc107; color: black; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer;">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ</button>
                    </div>
                    
                    <div id="interview-status" style="margin-top: 15px; text-align: center; color: #666;"></div>
                </div>
            `;
            
            document.body.appendChild(interviewModal);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ
            initializeInterview(sessionId);
        }
        
        async function initializeInterview(sessionId) {
            const messagesDiv = document.getElementById('chat-messages');
            const statusDiv = document.getElementById('interview-status');
            
            try {
                statusDiv.textContent = '–ó–∞–ø—É—Å–∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è...';
                
                const formData = new FormData();
                formData.append('session_id', sessionId);
                
                const response = await fetch(`${API_BASE}/start-interview`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ${response.status}`);
                }
                
                const result = await response.json();
                
                messagesDiv.innerHTML = `
                    <div style="margin-bottom: 15px; padding: 15px; background: #e3f2fd; border-radius: 10px; border-left: 4px solid #2196f3;">
                        <strong>–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä:</strong><br>
                        ${result.first_question || '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ.'}
                    </div>
                `;
                
                statusDiv.textContent = '–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å –≤—ã—à–µ.';
                
            } catch (error) {
                messagesDiv.innerHTML = `
                    <div style="color: red; text-align: center;">
                        –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è: ${error.message}<br>
                        <button onclick="initializeInterview('${sessionId}')" style="margin-top: 10px; background: #667eea; color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer;">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                    </div>
                `;
                statusDiv.textContent = '–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏';
            }
        }
        
        async function sendMessage(sessionId) {
            const messageInput = document.getElementById('user-message');
            const messagesDiv = document.getElementById('chat-messages');
            const statusDiv = document.getElementById('interview-status');
            
            const message = messageInput.value.trim();
            if (!message) return;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userMessageDiv = document.createElement('div');
            userMessageDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background: #f1f8e9; border-radius: 10px; border-left: 4px solid #4caf50;';
            userMessageDiv.innerHTML = `<strong>–í—ã:</strong><br>${message}`;
            messagesDiv.appendChild(userMessageDiv);
            
            messageInput.value = '';
            statusDiv.textContent = '–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞...';
            
            try {
                const formData = new FormData();
                formData.append('session_id', sessionId);
                formData.append('message', message);
                
                const response = await fetch(`${API_BASE}/interview-message`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${response.status}`);
                }
                
                const result = await response.json();
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞
                const aiMessageDiv = document.createElement('div');
                aiMessageDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background: #e3f2fd; border-radius: 10px; border-left: 4px solid #2196f3;';
                aiMessageDiv.innerHTML = `<strong>–ò–Ω—Ç–µ—Ä–≤—å—é–µ—Ä:</strong><br>${result.response || result.next_question || '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–≤–µ—Ç!'}`;
                messagesDiv.appendChild(aiMessageDiv);
                
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
                
                if (result.interview_completed) {
                    statusDiv.innerHTML = `
                        <span style="color: #28a745;">–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</span>
                        <button onclick="showResults('${sessionId}')" style="margin-left: 10px; background: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                    `;
                } else {
                    statusDiv.textContent = '–û–∂–∏–¥–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞...';
                }
                
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'margin-bottom: 15px; padding: 15px; background: #ffebee; border-radius: 10px; border-left: 4px solid #f44336; color: red;';
                errorDiv.innerHTML = `<strong>–û—à–∏–±–∫–∞:</strong><br>${error.message}`;
                messagesDiv.appendChild(errorDiv);
                
                statusDiv.textContent = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è';
            }
        }
        
        async function completeInterview(sessionId) {
            const statusDiv = document.getElementById('interview-status');
            
            try {
                const response = await fetch(`${API_BASE}/interview/complete/${sessionId}`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    statusDiv.innerHTML = `
                        <span style="color: #28a745;">–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</span>
                        <button onclick="showResults('${sessionId}')" style="margin-left: 10px; background: #17a2b8; color: white; border: none; padding: 8px 16px; border-radius: 15px; cursor: pointer;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                    `;
                } else {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è');
                }
            } catch (error) {
                statusDiv.innerHTML = `<span style="color: red;">–û—à–∏–±–∫–∞: ${error.message}</span>`;
            }
        }
        
        async function showResults(sessionId) {
            try {
                const response = await fetch(`${API_BASE}/session-report/${sessionId}`);
                if (response.ok) {
                    const results = await response.json();
                    alert(`–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è:\n\n–û—Ü–µ–Ω–∫–∞: ${results.overall_score || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞'}\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: ${results.recommendations || '–û—Ç—á–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è...'}`);
                } else {
                    alert('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: ' + error.message);
            }
        }
        
        function toggleVoiceMode(sessionId) {
            alert('–ì–æ–ª–æ—Å–æ–≤–æ–π —Ä–µ–∂–∏–º –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ STT/TTS —Å–µ—Ä–≤–∏—Å–æ–≤');
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        checkBackendStatus();
        
        // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
        setInterval(checkBackendStatus, 30000);
    </script>
</body>
</html>